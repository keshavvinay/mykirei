!function(t,l){var i;function m(s,t,n){console.log("call servlet"),common.instagram.utils.getLatestData(document.URL,t,function(t){null!=t.data?g(s,t):r(s),n.resolve()})}function r(t){t.find(".g-InstagramPost__error").show()}function g(t,s){var n,_,o=t.data("number"),a=t.data("date-format"),e=t.data("link-label"),c=t.find(".g-InstagramPost__inner");n=function(t,s,n,_,o){var a=[];if(null==s.length)return a;for(var e=0;e<s.length&&e<n;e++){var c={};s[e].caption?(c.text=s[e].caption.text,c.text=c.text.replace(/(?:^|[^ーー゛゜々ヾヽぁ-ヶ一-龠ａ-ｚＡ-Ｚ０-９a-zA-Z0-9À-ɏ&_/>]+)[#＃]([ー゛゜々ヾヽぁ-ヶ一-龠ａ-ｚＡ-Ｚ０-９a-zA-Z0-9À-ɏ_]*[ー゛゜々ヾヽぁ-ヶ一-龠ａ-ｚＡ-Ｚ０-９a-zA-ZÀ-ɏ]+[ー゛゜々ヾヽぁ-ヶ一-龠ａ-ｚＡ-Ｚ０-９a-zA-Z0-9À-ɏ_]*)/gi,' <a href="https://www.instagram.com/explore/tags/$1" target="_blank">#$1</a>')):c.text="",c.date=moment.unix(Number(s[e].created_time)).format(_),c.type=s[e].type,c.imageUrl=s[e].images.standard_resolution.url,"video"===c.type?c.videoUrl=s[e].videos.standard_resolution.url:"carousel"===c.type&&(s[e].videos?(c.type="video",c.videoUrl=s[e].videos.standard_resolution.url):c.type="image"),c.likes=s[e].likes.count,c.comments=s[e].comments.count,c.linkLabel=o,c.linkUrl=s[e].link,c.smallViewTop=t.hasClass("is-smallViewTop"),a.push(c)}return a}(t,s.data,o,a,e),$.templates("mediaTmpl",'<div class="g-InstagramPost__contentsBlock__image l-InstagramPost__contentsBlock__image"><div class="g-InstagramPost__contentsBlock__image__inner l-InstagramPost__contentsBlock__image__inner">{{if type == "image"}}<img src="{{:imageUrl}}" width="100%" alt="">{{else type == "video"}}<video src="{{:videoUrl}}" width="100%" controls poster="{{:imageUrl}}"></video>{{/if}}</div></div>'),$.templates("postTmpl",'<div class="g-InstagramPostUnit l-InstagramPostUnit"><div class="g-InstagramPost__contentsBlock l-InstagramPost__contentsBlock">{{if smallViewTop}}{{include tmpl="mediaTmpl"/}}{{/if}}<div class="g-InstagramPost__contentsBlock__text l-InstagramPost__contentsBlock__text"><div class="g-InstagramPost__contentsBlock__date l-InstagramPost__contentsBlock__date">{{:date}}</div><div class="g-InstagramPost__contentsBlock__postText l-InstagramPost__contentsBlock__postText"><p class="g-InstagramPost__contentsBlock__postText__text l-InstagramPost__contentsBlock__postText__text">{{:text}}</p></div><div class="g-InstagramPost__contentsBlock__counts__wrapper l-InstagramPost__contentsBlock__counts__wrapper"><ul class="g-InstagramPost__contentsBlock__counts l-InstagramPost__contentsBlock__counts"><li class="g-InstagramPost__contentsBlock__counts__item l-InstagramPost__contentsBlock__counts__item g-InstagramPost__contentsBlock__counts__item--likes l-InstagramPost__contentsBlock__counts__item--likes"><span class="g-InstagramPost__contentsBlock__counts__item__inner l-InstagramPost__contentsBlock__counts__item__inner"><span class="cmn-icon cmn-icon--heart g-InstagramPost__contentsBlock__counts__item__icon l-InstagramPost__contentsBlock__counts__item__icon"></span><span class="g-InstagramPost__contentsBlock__counts__item__label l-InstagramPost__contentsBlock__counts__item__label">{{:likes}}</span></span></li><li class="g-InstagramPost__contentsBlock__counts__item l-InstagramPost__contentsBlock__counts__item g-InstagramPost__contentsBlock__counts__item--comments l-InstagramPost__contentsBlock__counts__item--comments"><span class="g-InstagramPost__contentsBlock__counts__item__inner l-InstagramPost__contentsBlock__counts__item__inner"><span class="cmn-icon cmn-icon--comment g-InstagramPost__contentsBlock__counts__item__icon l-InstagramPost__contentsBlock__counts__item__icon"></span><span class="g-InstagramPost__contentsBlock__counts__item__label l-InstagramPost__contentsBlock__counts__item__label">{{:comments}}</span></span></li></ul></div><div class="g-InstagramPost__contentsBlock__visit l-InstagramPost__contentsBlock__visit opt-hide-sm"><a href="{{:linkUrl}}" target="_blank" class="g-InstagramPost__contentsBlock__visit__link l-InstagramPost__contentsBlock__visit__link"><span class="cmn-icon cmn-icon--window g-InstagramPost__contentsBlock__visit__icon l-InstagramPost__contentsBlock__visit__icon"></span><span class="g-InstagramPost__contentsBlock__visit__label l-InstagramPost__contentsBlock__visit__label">{{:linkLabel}}</span></a></div></div>{{if !smallViewTop}}{{include tmpl="mediaTmpl"/}}{{/if}}<div class="g-InstagramPost__contentsBlock__visit l-InstagramPost__contentsBlock__visit opt-hide-lg opt-hide-md"><a href="{{:linkUrl}}" target="_blank" class="g-InstagramPost__contentsBlock__visit__link l-InstagramPost__contentsBlock__visit__link"><span class="cmn-icon cmn-icon--window g-InstagramPost__contentsBlock__visit__icon l-InstagramPost__contentsBlock__visit__icon"></span><span class="g-InstagramPost__contentsBlock__visit__label l-InstagramPost__contentsBlock__visit__label">{{:linkLabel}}</span></a></div></div></div>'),_=$.render.postTmpl(n),c.html(_),i&&r(t),l.initAddedVideo()}$(document).ready(function(){var t;i=$.fn.isAuthorring(),(t=$(".js-InstagramPost"))[0]&&t.each(function(){var a=$(this),e=a.data("path"),c=new $.Deferred;l.onloadAsyncDOM(c.promise()),$.ajax({url:e,cache:!1,type:"GET",dataType:"json"}).done(function(t,s,n){console.log("success");var _=moment(new Date(n.getResponseHeader("Last-Modified"))),o=moment(new Date(n.getResponseHeader("Date")));o.diff(_)<72e3?(g(a,t),c.resolve()):m(a,e,c)}).fail(function(t,s){console.log("error:"+s),m(a,e,c)}).always(function(){console.log("complete")})})})}(window,window.kaoAPI||(window.kaoAPI={}));