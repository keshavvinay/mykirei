!function(t,c){var a;function r(e,t,_){console.log("call servlet"),common.twitter.utils.getLatestData(document.URL,t,function(t){null!=t.length?k(e,t):w(e),_.resolve()})}function w(t){t.find(".g-TwitterPost__error").show()}function k(t,e){var _,i,n=t.data("number"),s=t.data("date-format"),o=t.data("link-label"),l=t.find(".g-TwitterPost__inner");_=function(t,e,_,i,n){var s=[];if(null==e.length)return s;for(var o=0;o<e.length&&o<_;o++){var l={};l.text=$.fn.replaceLink(e[o].text,"_blank"),l.text=l.text.replace(/(?:^|[^ーー゛゜々ヾヽぁ-ヶ一-龠ａ-ｚＡ-Ｚ０-９a-zA-Z0-9À-ɏ&_/>]+)[#＃]([ー゛゜々ヾヽぁ-ヶ一-龠ａ-ｚＡ-Ｚ０-９a-zA-Z0-9À-ɏ_]*[ー゛゜々ヾヽぁ-ヶ一-龠ａ-ｚＡ-Ｚ０-９a-zA-ZÀ-ɏ]+[ー゛゜々ヾヽぁ-ヶ一-龠ａ-ｚＡ-Ｚ０-９a-zA-Z0-9À-ɏ_]*)/gi,' <a href="http://twitter.com/search?q=%23$1" target="_blank">#$1</a>'),l.text=l.text.replace(/(^|\s)(@|＠)(\w+)/g,'$1<a href="http://www.twitter.com/$3" target="_blank">@$3</a>'),l.date=moment(e[o].created_at,"ddd MMM DD HH:mm:ss Z YYYY").format(i),e[o].extended_entities?(l.hasMedia=!0,"video"==e[o].extended_entities.media[0].type||"animated_gif"==e[o].extended_entities.media[0].type?(l.type="video",l.variants=e[o].extended_entities.media[0].video_info.variants):"photo"==e[o].extended_entities.media[0].type?l.type="image":l.hasMedia=!1,l.hasMedia&&(l.mediaUrl=e[o].extended_entities.media[0].media_url_https)):l.hasMedia=!1,l.id=e[o].id_str,l.screenName=e[o].user.screen_name,l.rtCount=e[o].retweet_count,l.favCount=e[o].favorite_count,l.linkLabel=n,l.smallViewTop=t.hasClass("is-smallViewTop"),s.push(l)}return s}(t,e,n,s,o),$.templates("mediaTmpl",'{{if hasMedia}}<div class="g-TwitterPost__contentsBlock__image l-TwitterPost__contentsBlock__image"><div class="g-TwitterPost__contentsBlock__image__inner l-TwitterPost__contentsBlock__image__inner">{{if type == "image"}}<img src="{{:mediaUrl}}" width="100%" alt="">{{else}}<video width="100%" controls poster="{{:mediaUrl}}">{{for variants}}<source src="{{:url}}" type="{{:content_type}}">{{/for}}</video>{{/if}}</div></div>{{/if}}'),$.templates("tweetTmpl",'<div class="g-TwitterPostUnit l-TwitterPostUnit {{if !hasMedia}}is-none-media{{/if}}"><div class="g-TwitterPost__contentsBlock l-TwitterPost__contentsBlock">{{if smallViewTop}}{{include tmpl="mediaTmpl"/}}{{/if}}<div class="g-TwitterPost__contentsBlock__text l-TwitterPost__contentsBlock__text"><div class="g-TwitterPost__contentsBlock__date l-TwitterPost__contentsBlock__date">{{:date}}</div><div class="g-TwitterPost__contentsBlock__tweet l-TwitterPost__contentsBlock__tweet"><p class="g-TwitterPost__contentsBlock__tweet__text l-TwitterPost__contentsBlock__tweet__text">{{:text}}</p></div><div class="g-TwitterPost__contentsBlock__links__wrapper l-TwitterPost__contentsBlock__links__wrapper"><ul class="g-TwitterPost__contentsBlock__links l-TwitterPost__contentsBlock__links"><li class="g-TwitterPost__contentsBlock__links__item l-TwitterPost__contentsBlock__links__item g-TwitterPost__contentsBlock__links__item--reply l-TwitterPost__contentsBlock__links__item--reply"><a href="http://twitter.com/intent/tweet?in_reply_to={{:id}}" target="_blank" class="g-TwitterPost__contentsBlock__links__item__link l-TwitterPost__contentsBlock__links__item__link" onclick="window.open(this.href, \'TWwindow\', \'width=650, height=450, menubar=no, toolbar=no, scrollbars=yes\'); return false;"><span class="cmn-icon cmn-icon--reply g-TwitterPost__contentsBlock__links__item__icon l-TwitterPost__contentsBlock__links__item__icon"></span><span class="g-TwitterPost__contentsBlock__links__item__label l-TwitterPost__contentsBlock__links__item__label">Reply</span></a></li><li class="g-TwitterPost__contentsBlock__links__item l-TwitterPost__contentsBlock__links__item g-TwitterPost__contentsBlock__links__item--rt l-TwitterPost__contentsBlock__links__item--rt"><a href="http://twitter.com/intent/retweet?tweet_id={{:id}}" target="_blank" class="g-TwitterPost__contentsBlock__links__item__link l-TwitterPost__contentsBlock__links__item__link" onclick="window.open(this.href, \'TWwindow\', \'width=650, height=450, menubar=no, toolbar=no, scrollbars=yes\'); return false;"><span class="cmn-icon cmn-icon--retweet g-TwitterPost__contentsBlock__links__item__icon l-TwitterPost__contentsBlock__links__item__icon"></span><span class="g-TwitterPost__contentsBlock__links__item__label l-TwitterPost__contentsBlock__links__item__label">{{:rtCount}}</span></a></li><li class="g-TwitterPost__contentsBlock__links__item l-TwitterPost__contentsBlock__links__item g-TwitterPost__contentsBlock__links__item--fav l-TwitterPost__contentsBlock__links__item--fav"><a href="http://twitter.com/intent/favorite?tweet_id={{:id}}" target="_blank" class="g-TwitterPost__contentsBlock__links__item__link l-TwitterPost__contentsBlock__links__item__link" onclick="window.open(this.href, \'TWwindow\', \'width=650, height=450, menubar=no, toolbar=no, scrollbars=yes\'); return false;"><span class="cmn-icon cmn-icon--heart g-TwitterPost__contentsBlock__links__item__icon l-TwitterPost__contentsBlock__links__item__icon"></span><span class="g-TwitterPost__contentsBlock__links__item__label l-TwitterPost__contentsBlock__links__item__label">{{:favCount}}</span></a></li></ul></div><div class="g-TwitterPost__contentsBlock__visit l-TwitterPost__contentsBlock__visit opt-hide-sm"><a href="https://twitter.com/{{:screenName}}/status/{{:id}}" target="_blank" class="g-TwitterPost__contentsBlock__visit__link l-TwitterPost__contentsBlock__visit__link"><span class="cmn-icon cmn-icon--window g-TwitterPost__contentsBlock__visit__icon l-TwitterPost__contentsBlock__visit__icon"></span><span class="g-TwitterPost__contentsBlock__visit__label l-TwitterPost__contentsBlock__visit__label">{{:linkLabel}}</span></a></div></div>{{if !smallViewTop}}{{include tmpl="mediaTmpl"/}}{{/if}}<div class="g-TwitterPost__contentsBlock__visit l-TwitterPost__contentsBlock__visit opt-hide-lg opt-hide-md"><a href="https://twitter.com/{{:screenName}}/status/{{:id}}" target="_blank" class="g-TwitterPost__contentsBlock__visit__link l-TwitterPost__contentsBlock__visit__link"><span class="cmn-icon cmn-icon--window g-TwitterPost__contentsBlock__visit__icon l-TwitterPost__contentsBlock__visit__icon"></span><span class="g-TwitterPost__contentsBlock__visit__label l-TwitterPost__contentsBlock__visit__label">{{:linkLabel}}</span></a></div></div></div>'),i=$.render.tweetTmpl(_),l.html(i),a&&w(t),c.initAddedVideo()}$(document).ready(function(){var t;a=$.fn.isAuthorring(),(t=$(".js-TwitterPost"))[0]&&t.each(function(){var s=$(this),o=s.data("path"),l=new $.Deferred;c.onloadAsyncDOM(l.promise()),$.ajax({url:o,cache:!1,type:"GET",dataType:"json"}).done(function(t,e,_){console.log("success");var i=moment(new Date(_.getResponseHeader("Last-Modified"))),n=moment(new Date(_.getResponseHeader("Date")));n.diff(i)<3e5?(k(s,t),l.resolve()):r(s,o,l)}).fail(function(t,e){console.log("error:"+e),r(s,o,l)}).always(function(){console.log("complete")})})})}(window,window.kaoAPI||(window.kaoAPI={}));